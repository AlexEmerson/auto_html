<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Auto html by dejan</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Auto html</h1>
<p>Rails extension for transforming URLs to appropriate resource (image, link, YouTube, Vimeo video,...) </p>
        <p class="view"><a href="https://github.com/dejan/auto_html">View the Project on GitHub <small>dejan/auto_html</small></a></p>
        <ul>
          <li><a href="https://github.com/dejan/auto_html/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/dejan/auto_html/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/dejan/auto_html">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>auto_html</h1>

<p>auto_html is a Rails extension for transforming URLs to appropriate resource (image, link, YouTube, Vimeo video,...). It's the perfect choice if you don't want to bother visitors with rich HTML editor or markup code, but you still want to allow them to embed video, images, links and more on your site, purely by pasting URL. Check out the <a href="http://auto-html.rors.org">live demo</a>.</p>

<h2>Example usage</h2>

<p>Transforming string with text and URLs is done with <em>auto_html</em> method:</p>

<pre><code>include AutoHtml

auto_html('Hey! Checkout out: <a href="http://vukajlija.com'">http://vukajlija.com'</a>) { simple_format; link(:target =&gt; 'blank') }
=&gt; "&lt;p&gt;Hey! Checkout out: &lt;a href='<a href="http://vukajlija.com">http://vukajlija.com</a>' target='blank'&gt;<a href="http://vukajlija.com&lt;/a&gt;&lt;/p&gt;">http://vukajlija.com&lt;/a&gt;&lt;/p&gt;</a>"
</code></pre>

<p>You'll probably have user input stored in model, so it's a good place to automate and even store this conversion for performance reason. This is done with <em>auto_html_for</em> method. Let's say you have model Comment with attribute body. Create another column in table Comments called body_html (again, this is optional but recommended for performance reasons). Now have something like this: </p>

<pre><code>class Comment &lt; ActiveRecord::Base
  auto_html_for :body do
    html_escape
    image
    youtube(:width =&gt; 400, :height =&gt; 250)
    link :target =&gt; "_blank", :rel =&gt; "nofollow"
    simple_format
  end
end
</code></pre>

<p>... and you'll have this behaviour: </p>

<pre><code>Comment.create(:body =&gt; 'Hey check out this cool video: <a href="http://www.youtube.com/watch?v=WdsGihou8J4'">http://www.youtube.com/watch?v=WdsGihou8J4'</a>)  
=&gt; #&lt;Comment id: 123, body: '&lt;p&gt;Hey check out this cool video: &lt;iframe class="youtube-player" type="text/html" width="587" height="350" src="<a href="http://www.youtube.com/embed/WdsGihou8J4">http://www.youtube.com/embed/WdsGihou8J4</a>" frameborder="0"&gt; &lt;br /&gt;&lt;/iframe&gt;&lt;/p&gt;'&gt;
</code></pre>

<p>Note that order of invoking filters is important, ie. you want html_escape as first and link amongst last, so that it doesn't transform youtube URL to plain link.</p>

<p>Now all you have to do is to display it in template without escaping, since plugin took care of that:</p>

<pre><code>&lt;% for comment in @comments %&gt;
   &lt;li&gt;&lt;%= comment.body_html %&gt;&lt;/li&gt;
&lt;% end %&gt;
</code></pre>

<p>If you need to display preview, no problem. Have something like this as action in your controller:</p>

<pre><code>def preview
  comment = Comment.new(params[:comment])
  render :text =&gt; comment.body_html
end
</code></pre>

<p>AutoHtml is highly customizable, and you can easily create new filters that will transform user input any way you like. For instance, this is the image filter that comes bundled with plugin:</p>

<pre><code>AutoHtml.add_filter(:image) do |text|
  text.gsub(/http:\/\/.+\.(jpg|jpeg|bmp|gif|png)(\?\S+)?/i) do |match|
    %|&lt;img src="#{match}" alt=""/&gt;|
  end
end
</code></pre>

<h2>Non-ActiveRecord models</h2>

<p>AutoHtml uses standard ActiveModel API, which means that you can include AutoHtmlFor module (that automates transformation of the field) in any non-ActiveRecord model that uses ActiveModel. Here's working <a href="http://mongoid.org/">mongoid</a> example:</p>

<pre><code>class Post
  include Mongoid::Document
  include AutoHtmlFor

  field :body

  auto_html_for :body do
    simple_format
    link
  end
end
</code></pre>

<h2>Rake and Capistrano tasks</h2>

<p>AutoHtml has a Rake task for rebuilding cached in DB column values
Usage: <code>rake auto_html:rebuild CLASS=[your model]</code>
Where <code>[your model]</code> is the name of model which values you want to rebuild.</p>

<p>If you want to run it on remote server, just add this to your <code>deploy.rb</code>:</p>

<pre><code>require 'auto_html/capistrano'
</code></pre>

<p>Now you can run <code>cap auto_html:rebuild CLASS=[your_model]</code>.</p>

<h2>Bundled filters</h2>

<p>For filter list and options they support check: <a href="http://github.com/dejan/auto_html/tree/master/lib/auto_html/filters">http://github.com/dejan/auto_html/tree/master/lib/auto_html/filters</a></p>

<h2>Install</h2>

<p>Specify the gem in Gemfile of the project</p>

<pre><code>gem "auto_html"
</code></pre>

<h2>Credits</h2>

<p>Author: <a href="http://github.com/dejan">Dejan Simic</a><br>
Contributors: <a href="https://github.com/dejan/auto_html/contributors">https://github.com/dejan/auto_html/contributors</a></p>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/dejan">dejan</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>